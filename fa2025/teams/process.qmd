---
title: Process teaming file
author:
    - name: John Leonard
      email: jdleonard@vcu.edu
format:
    html:
        embed-resources: true
        html-math-method: katex
        theme: spacelab
        toc: true
---

This program processes the teaming survey from CMSC 408 and
sets things up for analysis.

## List of columns 

### Columns prior to renaming
```{python}
#| echo: false

import pandas as pd
import sqlite3
from cnvsapi import config

def format_column_names(df):
    results = []
    for i,column in enumerate(df.columns):
        results.append(f"'{column}' : '{column}',")
    return "\n".join( results )

# Load the xlsx file into a pandas dataframe
df = pd.read_excel('teaming.xlsx')

print(format_column_names(df))

# Rename columns (assuming you know the new column names)
# Replace 'old_col1', 'old_col2', etc., with your actual column names
# Replace 'new_col1', 'new_col2', etc., with the desired new column names
df.rename(columns={
    'Unnamed: 0' : 'row_id',
    'sortable_name' : 'sortable_name',
    'email' : 'partner_0_email',
    'sis_user_id/vid' : 'partner_0_vid',
    'Fill in the name of your team:' : 'team_name',
    'Enter name of your partner:' : 'partner_1_name',
    'Enter VCU email of your partner:' : 'partner_1_email',
    'OPTIONAL: Enter name of partner 2:' : 'partner_2_name',
    'OPTIONAL: Enter VCU email of partner 2:' : 'partner_2_email',
    'count' : 'count',
}, inplace=True)

# Connect to the SQLite database (or create it if it doesn't exist)
conn = sqlite3.connect('teaming.db')
df.to_sql('raw_table', conn, if_exists='replace', index=False)
conn.close()

```
### Columns after renaming
```{python}
df.columns
```