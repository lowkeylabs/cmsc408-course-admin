---
title: ""
format:
    html:
        minimal: true
execute:
    echo: false
---

```{python}
#| echo: false
#| output: asis

import pandas as pd

from cnvsapi.build_utils import get_current_week_from_lecture_id, get_outline_objects, extract_outline
from datetime import datetime, timedelta

outline_df = extract_outline().copy()
outline_df.loc[:,'date'] = pd.to_datetime(outline_df['DateCanvas']).dt.date

summary_df = outline_df.groupby('Module').agg(
    earliest_date=('date', 'min'),
    latest_date=('date', 'max')
).reset_index()
summary_df = summary_df.sort_values(by='earliest_date').reset_index(drop=True)

```


```{python}

def make_gantt():
    """ make gant chart """

    #original_date_str = "1/7/2024"
    #original_date = datetime.strptime(original_date_str, "%m/%d/%Y")
    #new_date = original_date + timedelta(weeks=(week_id - 1) )
    #new_date_str = new_date.strftime("%m/%d/%Y").lstrip("0").replace("/0", "/")


    # VCU gold: #FFB300

    # Define the content you want to write to the file
    content = []
    content.append(f"""gantt
    dateFormat YYYY-M-DD
    axisFormat %b %e
    todayMarker stroke-width:7px,stroke:#FFB300,opacity:0.5

    section Modules
"""
    )
    for i,item in summary_df.iterrows():
        content.append(f"    {item['Module']} : m{i}, {item['earliest_date']}, {item['latest_date']}")

    # Open the file in write mode ('w' will create the file if it doesn't exist or overwrite it if it does)
    with open("./week-mermaid.mmd", "w") as file:
        file.write("\n".join(content))

make_gantt()
```

::: {.no-filter}
```{mermaid}
%%| echo: false
%%| file: week-mermaid.mmd
```
:::
